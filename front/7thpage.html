<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Application Form</title>
    <style>
        body {
    font-family: Arial, sans-serif;
    margin: 0;
    padding: 0;
}

h1, h2, h3 {
    color: #333;
    margin-bottom: 10px;

}
/* {
    margin-bottom: 30px;
    padding: 20px;
    border-radius: 5px;
    box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
} */

/* su{
    border: 1px solid #ccc;
    border-radius: 5px;
    margin-bottom: 20px;
    padding: 15px;
} */

table {
    border-collapse: collapse;
    width: 100%;
}
#SubmitButton {
    margin-top: 10px;
    background-color: #dc3545;
}

#SubmitButton:hover {
    background-color: #2333c8;
}
th, td {
    padding: 8px;
    text-align: left;
    border-bottom: 1px solid #ddd;
}

th {
    background-color: #f2f2f2;
}

input[type="file"] {
    margin-right: 10px;
}

button {
    background-color: #4CAF50;
    color: white;
    padding: 10px 20px;
    border: none;
    cursor: pointer;
    border-radius: 4px;
}

submit {
    background-color: #4CAF50;
    color: white;
    padding: 10px 20px;
    border: none;
    cursor: pointer;
    border-radius: 4px;
}


button:hover {
    background-color: #45a049;
}

select {
    padding: 6px;
    border-radius: 4px;
}

input[type="text"],
input[type="email"],
input[type="tel"] {
    padding: 6px;
    border-radius: 4px;
    border: 1px solid #ccc;
}
input[type="submit"]:hover,
button:hover {
    background-color: #0056b3;
}

#logoutButton {
    margin-top: 10px;
    background-color: #dc3545;
}

#logoutButton:hover {
    background-color: #2823c8;
}


    </style>
</head>
<body>
    <h1>Application Form</h1>
    <form action="http://127.0.0.1:8000/7thpage" method="post" enctype="multipart/form-data">
    <!--1: Reprints of 5 Best Research Papers -->
    
        <h2>Reprints of 5 Best Research Papers</h2>
        <button type="button" onclick="viewDocument('reprint')">View Uploaded Document</button>
        <input type="file" name="reprint_document" id="reprint_document">
    
    
    <!--2: Check List of the documents attached with the online application -->
    
        <h2>Check List of the documents attached with the online application</h2>
        
        <!-- Su PHD Certificate -->
        <h3>PHD Certificate</h3>
        <button type="button"  onclick="viewDocument('phd_certificate')">View Uploaded Document</button>
        <input type="file" name="phd_certificate_document" id="phd_certificate_document">
        
        <!-- Su PG Documents -->
        <h3>PG Documents</h3>
        <button type="button"  onclick="viewDocument('pg_documents')">View Uploaded Document</button>
        <input type="file" name="pg_documents_document" id="pg_documents_document">
        
        <!-- Su UG Documents -->
        <h3>UG Documents</h3>
        <button type="button"  onclick="viewDocument('ug_documents')">View Uploaded Document</button>
        <input type="file" name="ug_documents_document" id="ug_documents_document">
        
        <!-- Su 12th/HSC?Diploma documents -->
        <h3>12th/HSC/Diploma Documents</h3>
        <button type="button" onclick="viewDocument('diploma_documents')">View Uploaded Document</button>
        <input type="file" name="diploma_documents_document" id="diploma_documents_document">
        
        <!-- Su 10th/SSC documents -->
        <h3>10th/SSC Documents</h3>
        <button type="button"  onclick="viewDocument('ssc_documents')">View Uploaded Document</button>
        <input type="file" name="ssc_documents_document" id="ssc_documents_document">
        
        <!-- Su Pay Slip -->
        <h3>Pay Slip</h3>
        <button type="button"  onclick="viewDocument('pay_slip')">View Uploaded Document</button>
        <input type="file" name="pay_slip_document" id="pay_slip_document">
        
        <!-- Su NOC or Undertaking -->
        <h3>NOC or Undertaking</h3>
        <button type="button"  onclick="viewDocument('noc_undertaking')">View Uploaded Document</button>
        <input type="file" name="noc_undertaking_document" id="noc_undertaking_document">
        
        <!-- Su Post phd Experience Certificate/All Experience Certificates/Last Pay slip -->
        <h3>Post PhD Experience Certificate/All Experience Certificates/Last Pay Slip</h3>
        <button type="button"  onclick="viewDocument('experience_certificates')">View Uploaded Document</button>
        <input type="file" name="experience_certificates_document" id="experience_certificates_document">
        
        <!-- Su Upload any other relevant document in a single PDF -->
        <h3>Upload any other relevant document in a single PDF</h3>
        <button type="button"  onclick="viewDocument('other_documents')">View Uploaded Document</button>
        <input type="file" name="other_documents_document" id="other_documents_document">
    
    
    <!--3: Referees -->
    
        <h2>Referees</h2>
        <table>
            <thead>
                <tr>
                    <th>Name</th>
                    <th>Position</th>
                    <th>Association with Referee</th>
                    <th>Institution/Organization</th>
                    <th>E-mail</th>
                    <th>Contact No.</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><input type="text" name="referee_name_1" id="referee_name_1"></td>
                    <td><input type="text" name="referee_position_1" id="referee_position_1"></td>
                    <td>
                        <select name="referee_association_1" id="referee_association_1">
                            <option value="Thesis supervisor">Thesis supervisor</option>
                            <option value="Postdoc Supervisor">Postdoc Supervisor</option>
                            <option value="Research Collabrator">Research Collabrator</option>
                            <option value="Other">Other</option>
                        </select>
                    </td>
                    <td><input type="text" name="referee_institution_1" id="referee_institution_1"></td>
                    <td><input type="email" name="referee_email_1" id="referee_email_1"></td>
                    <td><input type="tel" name="referee_contact_1" id="referee_contact_1"></td>
                </tr>
                <tr>
                    <td><input type="text" name="referee_name_2" id="referee_name_2"></td>
                    <td><input type="text" name="referee_position_2" id="referee_position_2"></td>
                    <td>
                        <select name="referee_association_2" id="referee_association_2">
                            <option value="Thesis supervisor">Thesis supervisor</option>
                            <option value="Postdoc Supervisor">Postdoc Supervisor</option>
                            <option value="Research Collabrator">Research Collabrator</option>
                            <option value="Other">Other</option>
                        </select>
                    </td>
                    <td><input type="text" name="referee_institution_2" id="referee_institution_2"></td>
                    <td><input type="email" name="referee_email_2" id="referee_email_2"></td>
                    <td><input type="tel" name="referee_contact_2" id="referee_contact_2"></td>
                </tr>
                <tr>
                    <td><input type="text" name="referee_name_3" id="referee_name_3"></td>
                    <td><input type="text" name="referee_position_3" id="referee_position_3"></td>
                    <td>
                        <select name="referee_association_3" id="referee_association_3">
                            <option value="Thesis supervisor">Thesis supervisor</option>
                            <option value="Postdoc Supervisor">Postdoc Supervisor</option>
                            <option value="Research Collabrator">Research Collabrator</option>
                            <option value="Other">Other</option>
                        </select>
                    </td>
                    <td><input type="text" name="referee_institution_3" id="referee_institution_3"></td>
                    <td><input type="email" name="referee_email_3" id="referee_email_3"></td>
                    <td><input type="tel" name="referee_contact_3" id="referee_contact_3"></td>
                </tr>
            </tbody>
        </table>
    
    <input type="submit" id="SubmitButton" value="Submit">
        <button type="button" id="logoutButton">Logout</button>
</form>
    <!-- JavaScript for document upload/view functionality -->
    <script>
        
        async function viewDocument(item) {
            const response = await fetch('http://127.0.0.1:8000/file');
            const fileData = await response.json();
            if(fileData.status==true){
            const fileType = fileData.content_type;
            const fileContent = fileData.file_content;

            // Decode base64-encoded file content
            const decodedFileContent = atob(fileContent);

            // Convert string to Uint8Array
            const arrayBuffer = new Uint8Array(decodedFileContent.length);
            for (let i = 0; i < decodedFileContent.length; i++) {
                arrayBuffer[i] = decodedFileContent.charCodeAt(i);
            }

            // Create Blob from Uint8Array
            const blob = new Blob([arrayBuffer], { type: fileType });

            // Create object URL for the Blob
            const objectUrl = URL.createObjectURL(blob);

            // Create temporary anchor element
            const link = document.createElement('a');
            link.href = objectUrl;
            link.download = `file.${fileType.split('/')[1]}`;

            // Programmatically trigger download
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }
        }

        window.onload=chec();
        async function chec(){
        const response = await fetch('http://127.0.0.1:8000/session7');
        const data = await response.json();
        console.log(data);
         if(data.status==true){

         dict=   [
    "referee_name_1", "referee_position_1", "referee_association_1", "referee_institution_1", "referee_email_1","referee_contact_1",
    "referee_name_2", "referee_position_2", "referee_association_2", "referee_institution_2", "referee_email_2","referee_contact_2",  
    "referee_name_3", "referee_position_3", "referee_association_3", "referee_institution_3", "referee_email_3","referee_contact_3",
         ]
            for(let item of dict){
                document.getElementById(item).value=data.referee[item]
            }
            
            

          
         }
         else{
             window.location.href="http://127.0.0.1:5500/front/login.html";
        }
    }
    async function logout() {
            const response = await fetch('http://127.0.0.1:8000/logout');
            window.location.href="http://127.0.0.1:5500/front/login.html";
        }

        // Add click event listener to the logout button
        document.getElementById('logoutButton').addEventListener('click', function(event){
            logout();
        });

        
    </script>
</body>
</html>
